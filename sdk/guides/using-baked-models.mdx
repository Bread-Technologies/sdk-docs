---
title: "Using Your Baked Model"
description: "Load, chat with, and integrate your baked models in applications"
---

After your bake completes, your model contains the baked behavior in its weights. This guide shows how to use your baked model for inference, chat, and application integration.

<Note>
Completed [your first bake](/sdk/guides/single-prompt-bake)? Your trained model is ready to use.
</Note>

## Model Path Format

Baked models are referenced using this path format:

```
[username]/[repo_name]/[bake_name]/[checkpoint_number]
```

**Example:**
```
johndoe/my_repo/my_bake_v1/35
```

**Components:**
- `username` - Your Bread username or team name
- `repo_name` - The repository containing the bake
- `bake_name` - The specific bake configuration
- `checkpoint_number` - Training checkpoint (usually final checkpoint)

<Info>
Find your checkpoint number in the bake output or training logs. The final checkpoint represents the fully trained model.
</Info>

---

---

## Using Baked Models for Inference

### API-Based Inference

Use your baked model through the Bread API with OpenAI-compatible endpoints:

<CodeGroup>

```python Python
import os
import requests

response = requests.post(
    "https://bapi.bread.com.ai/v1/chat/completions",
    headers={"Authorization": f"Bearer {os.environ.get('BREAD_API_KEY')}"},
    json={
        "model": "johndoe/yoda_repo/yoda_bake_v1/35",
        "messages": [{"role": "user", "content": "How do I master the Force?"}],
        "max_tokens": 1000
    }
)

print(response.json())
```

```typescript TypeScript
const response = await fetch('https://bapi.bread.com.ai/v1/chat/completions', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${process.env.BREAD_API_KEY}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    model: 'johndoe/yoda_repo/yoda_bake_v1/35',
    messages: [{ role: 'user', content: 'How do I master the Force?' }],
    max_tokens: 1000,
  }),
});

const data = await response.json();
console.log(data);
```

</CodeGroup>

<Info>
**Key requirements:**
- `BREAD_API_KEY` environment variable must be set
- Update `MODEL_NAME` to your baked model path: `username/repo/bake/checkpoint`
- Base URL: `https://bapi.bread.com.ai/v1/chat/completions`
</Info>

### Streaming Responses

Enable streaming for real-time response generation:

<CodeGroup>

```python Python
import os
import requests
import json

response = requests.post(
    "https://bapi.bread.com.ai/v1/chat/completions",
    headers={"Authorization": f"Bearer {os.environ.get('BREAD_API_KEY')}"},
    json={
        "model": "johndoe/yoda_repo/yoda_bake_v1/35",
        "messages": [{"role": "user", "content": "I want to use the Force"}],
        "stream": True
    },
    stream=True
)

for line in response.iter_lines():
    if line and line.startswith(b"data: "):
        data = line.decode().removeprefix("data: ")
        if data != "[DONE]":
            chunk = json.loads(data)
            content = chunk["choices"][0]["delta"].get("content")
            if content:
                print(content, end="", flush=True)
```

```typescript TypeScript
const response = await fetch('https://bapi.bread.com.ai/v1/chat/completions', {
  method: 'POST',
  headers: {
    'Authorization': `Bearer ${process.env.BREAD_API_KEY}`,
    'Content-Type': 'application/json',
  },
  body: JSON.stringify({
    model: 'johndoe/yoda_repo/yoda_bake_v1/35',
    messages: [{ role: 'user', content: 'I want to use the Force' }],
    stream: true,
  }),
});

const reader = response.body?.getReader();
const decoder = new TextDecoder();

if (reader) {
  while (true) {
    const { done, value } = await reader.read();
    if (done) break;
    
    const chunk = decoder.decode(value);
    const lines = chunk.split('\n');
    
    for (const line of lines) {
      if (line.startsWith('data: ')) {
        const data = line.slice(6);
        if (data === '[DONE]') continue;
        
        const parsed = JSON.parse(data);
        const content = parsed.choices?.[0]?.delta?.content;
        if (content) {
          process.stdout.write(content);
        }
      }
    }
  }
}
```

</CodeGroup>

---

## Configuration Requirements

### Essential Settings

To use your baked model, you need three things:

<CardGroup cols={3}>
  <Card title="Your API Key" icon="key">
  </Card>
  <Card title="Our Base URL" icon="globe">
  </Card>
  <Card title="Your Model Path" icon="route">
  </Card>
</CardGroup>

**Example configuration:**

<CodeGroup>

```python Python
import os

BREAD_API_KEY = os.environ.get("BREAD_API_KEY")
BASE_URL = "https://bapi.bread.com.ai/v1/chat/completions"
MODEL_NAME = "johndoe/yoda_repo/yoda_bake_v1/35"
```

```typescript TypeScript
const BREAD_API_KEY = process.env.BREAD_API_KEY;
const BASE_URL = 'https://bapi.bread.com.ai/v1/chat/completions';
const MODEL_NAME = 'johndoe/yoda_repo/yoda_bake_v1/35';
```

</CodeGroup>

<Warning>
Always read `BREAD_API_KEY` from environment variables. Never hardcode API keys in your code.
</Warning>

---

## Common Issues

### Model not found

**Problem:** Model path is incorrect or checkpoint doesn't exist.

**Solution:**

<CodeGroup>

```python Python
from aibread import Bread

client = Bread()

# Verify bake completed successfully
status = client.bakes.get(
    bake_name="your_bake_name",
    repo_name="your_repo_name"
)
print(f"Status: {status.status}")  # Should be "complete"
print(f"Checkpoint: {status.checkpoint}")  # Use this in model path
```

```typescript TypeScript
import Bread from '@aibread/sdk';

const client = new Bread();

// Verify bake completed successfully
const status = await client.bakes.get('your_bake_name', {
  repo_name: 'your_repo_name',
});
console.log(`Status: ${status.status}`);  // Should be "complete"
console.log(`Checkpoint: ${status.checkpoint}`);  // Use this in model path
```

</CodeGroup>

### Model doesn't exhibit baked behavior

**Problem:** Student prompt wasn't empty or bake didn't complete.

**Solution:**

<CodeGroup>

```python Python
from aibread import Bread

client = Bread()

# Check bake status
status = client.bakes.get(
    bake_name="your_bake_name",
    repo_name="your_repo_name"
)

if status.status != "complete":
    print(f"Bake not complete: {status.status}")
    raise RuntimeError("Bake must be complete before using model")

# Verify student prompt was empty (for always-on behavior)
target = client.targets.get(
    target_name="your_target_name",
    repo_name="your_repo_name"
)
if target.v != "":
    print("Warning: Student prompt is not empty. Model requires prompt trigger.")

# Check training logs for convergence
# A good loss is ~4e-7
print(f"Final loss: {status.final_loss if hasattr(status, 'final_loss') else 'N/A'}")
```

```typescript TypeScript
import Bread from '@aibread/sdk';

const client = new Bread();

// Check bake status
const status = await client.bakes.get('your_bake_name', {
  repo_name: 'your_repo_name',
});

if (status.status !== 'complete') {
  console.log(`Bake not complete: ${status.status}`);
  throw new Error('Bake must be complete before using model');
}

// Verify student prompt was empty (for always-on behavior)
const target = await client.targets.get('your_target_name', {
  repo_name: 'your_repo_name',
});
if (target.v !== '') {
  console.log('Warning: Student prompt is not empty. Model requires prompt trigger.');
}

// Check training logs for convergence
// A good loss is ~4e-7
console.log(`Final loss: ${status.final_loss || 'N/A'}`);
```

</CodeGroup>

---

## Best Practices

<AccordionGroup>
  <Accordion title="Test Before Production" icon="vial">
    Always test your baked model thoroughly before deploying to production. Verify it exhibits the expected behavior consistently.
  </Accordion>

  <Accordion title="Version Your Models" icon="code-branch">
    Use clear naming: `model_v1`, `model_v2`, etc. Track which version is deployed where.
  </Accordion>

  <Accordion title="Monitor Behavior" icon="chart-line">
    Log model outputs in production to ensure baked behavior remains consistent over time.
  </Accordion>

  <Accordion title="Keep Training Data" icon="database">
    Save stim and rollout outputs. Useful for debugging and iterative improvements.
  </Accordion>

  <Accordion title="Document Your Prompts" icon="file-lines">
    Keep records of teacher/student prompts used for each model version. Essential for reproducibility.
  </Accordion>
</AccordionGroup>

---

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Iterative Baking"
    icon="rotate"
    href="/sdk/guides/iterative-baking"
  >
    Refine your baked model with additional training
  </Card>
  <Card
    title="Multi-Target Baking"
    icon="layer-group"
    href="/sdk/guides/multi-target-baking"
  >
    Bake multiple behaviors into one model
  </Card>
  <Card
    title="Production Patterns"
    icon="shield"
    href="/sdk/guides/production-patterns"
  >
    Add monitoring and error handling
  </Card>
  <Card
    title="Bake Configuration"
    icon="gear"
    href="/sdk/configuration/bake-config"
  >
    Customize training hyperparameters
  </Card>
</CardGroup>

