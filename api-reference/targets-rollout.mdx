---
title: "Trajectory Generation (Rollout)"
description: "Generate model responses to stimuli"
---

## Overview

Rollout generation creates model responses (trajectories) for each stimulus generated by a stim job. Rollout output is used as training data for bakes.

**Resource**: `client.targets.rollout`

## Methods

### run()

Start a rollout job for the target.

**Endpoint**: `POST /v1/repo/{repo_name}/targets/{target_name}/rollout`

```python
result = client.targets.rollout.run(
    target_name="coding_target",
    repo_name="my_repo"
)
print(result.status)
```

<ParamField path="target_name" type="string" required>
  Target name
</ParamField>

<ParamField path="repo_name" type="string" required>
  Repository name
</ParamField>

**Prerequisites**:
- Completed stim job (stim output must exist)
- Target must have `model_name` configured

<Check>
Verify stim job is complete before running rollout
</Check>

**Behavior**:
- Creates job marker and returns immediately
- Job executes asynchronously in background
- Idempotent: repeated calls return current state

**Returns**: `RolloutRunResponse`
- `status`: Job status
- `lines`: Number of trajectories generated
- `parameters`: Job configuration

---

### get()

Get rollout job status.

**Endpoint**: `GET /v1/repo/{repo_name}/targets/{target_name}/rollout`

```python
status = client.targets.rollout.get(
    target_name="coding_target",
    repo_name="my_repo"
)
print(f"Status: {status.status}")
print(f"Lines: {status.lines}")
```

<ParamField path="target_name" type="string" required>
  Target name
</ParamField>

<ParamField path="repo_name" type="string" required>
  Repository name
</ParamField>

**Returns**: `RolloutGetResponse`
- `status`: not_started | running | complete
- `lines`: Number of generated trajectories
- `parameters`: Job configuration

---

### get_output()

Get paginated rollout output data.

**Endpoint**: `GET /v1/repo/{repo_name}/targets/{target_name}/rollout/output`

```python
output = client.targets.rollout.get_output(
    target_name="coding_target",
    repo_name="my_repo",
    limit=100,
    offset=0
)

for trajectory in output.output:
    print(trajectory)
```

<ParamField path="target_name" type="string" required>
  Target name
</ParamField>

<ParamField path="repo_name" type="string" required>
  Repository name
</ParamField>

<ParamField path="limit" type="integer">
  Number of lines to return (max 1000)
</ParamField>

<ParamField path="offset" type="integer">
  Starting line number (0-indexed)
</ParamField>

**Returns**: `RolloutGetOutputResponse`
- `status`: Job status
- `lines`: Total number of trajectories
- `offset`: Starting offset
- `limit`: Page size
- `has_more`: Whether more data available
- `output`: List of generated trajectories
- `parameters`: Rollout configuration

---

## Complete Workflow Example

<Steps>
  <Step title="Verify Stim Complete">
    ```python
    stim_status = client.targets.stim.get(
        target_name="coding_target",
        repo_name="my_repo"
    )
    
    if stim_status.status != "complete":
        print("Stim job must complete before rollout")
        exit(1)
    
    print(f"Stim complete with {stim_status.lines} stimuli")
    ```
  </Step>

  <Step title="Start Rollout Job">
    ```python
    result = client.targets.rollout.run(
        target_name="coding_target",
        repo_name="my_repo"
    )
    print(f"Rollout started: {result.status}")
    ```
  </Step>

  <Step title="Poll Status">
    ```python
    import time
    
    while True:
        status = client.targets.rollout.get(
            target_name="coding_target",
            repo_name="my_repo"
        )
        
        if status.status == "complete":
            print(f"Complete! Generated {status.lines} trajectories")
            break
        
        print(f"Status: {status.status}, Lines: {status.lines}")
        time.sleep(10)  # Rollout can take longer, poll less frequently
    ```
  </Step>

  <Step title="Fetch Output">
    ```python
    output = client.targets.rollout.get_output(
        target_name="coding_target",
        repo_name="my_repo",
        limit=100
    )
    
    print(f"Retrieved {len(output.output)} trajectories")
    ```
  </Step>
</Steps>

## Stim + Rollout Combined Example

Run both stim and rollout in sequence:

```python
import time
from bread import Bread

client = Bread()

def wait_for_job(get_status_fn, job_name):
    """Poll job status until complete"""
    while True:
        status = get_status_fn()
        
        if status.status == "complete":
            print(f"{job_name} complete: {status.lines} lines")
            return status
        
        print(f"{job_name} status: {status.status}")
        time.sleep(5)

# Run stim
print("Starting stim job...")
client.targets.stim.run(
    target_name="coding_target",
    repo_name="my_repo"
)

# Wait for stim
stim_status = wait_for_job(
    lambda: client.targets.stim.get("coding_target", "my_repo"),
    "Stim"
)

# Run rollout
print("\nStarting rollout job...")
client.targets.rollout.run(
    target_name="coding_target",
    repo_name="my_repo"
)

# Wait for rollout
rollout_status = wait_for_job(
    lambda: client.targets.rollout.get("coding_target", "my_repo"),
    "Rollout"
)

# Get rollout output
output = client.targets.rollout.get_output(
    target_name="coding_target",
    repo_name="my_repo"
)

print(f"\nComplete! {len(output.output)} trajectories ready for training")
```

## Pagination Example

Fetch all rollout output:

```python
def get_all_rollout_output(target_name: str, repo_name: str):
    all_output = []
    offset = 0
    limit = 1000
    
    while True:
        chunk = client.targets.rollout.get_output(
            target_name=target_name,
            repo_name=repo_name,
            offset=offset,
            limit=limit
        )
        
        all_output.extend(chunk.output)
        print(f"Fetched {len(chunk.output)} trajectories (total: {len(all_output)})")
        
        if not chunk.has_more:
            break
        
        offset += limit
    
    return all_output

trajectories = get_all_rollout_output("coding_target", "my_repo")
```

## Understanding Trajectories

A trajectory represents the model's complete response to a stimulus:

```python
# Example trajectory structure
{
    "stimulus": "Write a function to reverse a string",
    "response": "def reverse_string(s):\n    return s[::-1]",
    "model": "Qwen/Qwen3-32B",
    "temperature": 1.0,
    "tokens": 25
}
```

## Multiple Trajectories Per Stimulus

Configure multiple responses per stimulus:

```python
# Configure target for multiple trajectories
client.targets.set(
    target_name="multi_traj_target",
    repo_name="my_repo",
    template="default",
    overrides={
        "model_name": "Qwen/Qwen3-32B",
        "num_traj_per_stimulus": 5,  # Generate 5 responses per question
        "temperature": 1.0
    }
)
```

<Tip>
Multiple trajectories per stimulus provide diverse training data and can improve model robustness.
</Tip>

## Best Practices

<AccordionGroup>
  <Accordion title="Verify Prerequisites" icon="list-check">
    Always check that stim job is complete and `model_name` is configured before running rollout
  </Accordion>

  <Accordion title="Poll Less Frequently" icon="clock">
    Rollout jobs can take longer than stim. Poll every 10-30 seconds instead of every 5 seconds
  </Accordion>

  <Accordion title="Monitor Progress" icon="chart-line">
    Check the `lines` field during polling to see generation progress
  </Accordion>

  <Accordion title="Handle Timeouts" icon="stopwatch">
    For large rollouts, configure appropriate timeout values on the client
  </Accordion>
</AccordionGroup>

## Error Handling

```python
import bread

try:
    result = client.targets.rollout.run(
        target_name="coding_target",
        repo_name="my_repo"
    )
except bread.NotFoundError:
    print("Target not found")
except bread.APIStatusError as e:
    if "stim" in str(e.response).lower():
        print("Stim job must complete first")
    elif "model_name" in str(e.response).lower():
        print("model_name must be configured")
    else:
        print(f"Error: {e.status_code} - {e.response}")
```

## Next Steps

<CardGroup cols={2}>
  <Card
    title="Bakes (Training)"
    icon="fire"
    href="/api-reference/bakes"
  >
    Use rollout data for model training
  </Card>
  <Card
    title="Complete Workflows"
    icon="diagram-project"
    href="/guides/workflows"
  >
    End-to-end workflow examples
  </Card>
</CardGroup>

